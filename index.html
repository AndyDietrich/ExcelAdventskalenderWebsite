<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Adventskalender 2025 - Rette Weihnachten!</title>
    <meta name="description" content="24 Excel-Aufgaben für die Adventszeit. Löse knifflige Rätsel und rette Weihnachten!">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>Excel Adventskalender 2025</h1>
                </div>
                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="home">Kalender</button>
                    <button class="nav-tab" data-tab="progress">Fortschritt</button>
                    <button class="nav-tab" data-tab="tasks">Aufgaben</button>
                    <button class="nav-tab" data-tab="info">Info</button>
                    <button class="nav-tab" data-tab="faq">FAQ</button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">

            <!-- Tab 1: Home / Kalender -->
            <section id="home-tab" class="tab-content active">
                <div class="hero">
                    <h2 class="hero-title">Rette Weihnachten mit Excel!</h2>
                    <p class="hero-text">
                        Der GRINCH-Virus hat Santas Werkstatt lahmgelegt.
                        Löse 24 verschlüsselte Excel-Aufgaben und rette Weihnachten!
                    </p>
                    <div class="settings-bar">
                        <label class="toggle-switch">
                            <input type="checkbox" id="daily-release-toggle">
                            <span class="slider"></span>
                            <span class="toggle-label">Tägliche Freischaltung (ab 01.12.)</span>
                        </label>
                    </div>
                </div>

                <!-- Geschenk-Grid -->
                <div class="calendar-grid" id="calendar-grid">
                    <!-- Wird dynamisch mit JavaScript gefüllt -->
                </div>

                <!-- Fortschritts-Übersicht -->
                <div class="progress-summary">
                    <h3>Dein Fortschritt</h3>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%">
                                <span class="progress-text" id="progress-text">0/24</span>
                            </div>
                        </div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <span class="stat-value" id="total-points">0</span>
                            <span class="stat-label">Punkte</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="gold-count">0</span>
                            <span class="stat-label">Gold</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="silver-count">0</span>
                            <span class="stat-label">Silber</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="bronze-count">0</span>
                            <span class="stat-label">Bronze</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tab 2: Fortschritt / Tracker -->
            <section id="progress-tab" class="tab-content">
                <div class="tracker-container">
                    <h2>Dein Fortschritts-Tracker</h2>

                    <!-- User Name -->
                    <div class="user-section excel-card">
                        <label for="user-name">Dein Name:</label>
                        <input type="text" id="user-name" placeholder="Name eingeben..." class="excel-input">
                    </div>

                    <!-- Statistiken -->
                    <div class="stats-grid">
                        <div class="excel-card">
                            <div class="card-label">Gelöste Aufgaben</div>
                            <div class="card-value" id="solved-count">0 / 24</div>
                        </div>
                        <div class="excel-card">
                            <div class="card-label">Gesamtpunkte</div>
                            <div class="card-value" id="total-points-detail">0 / 72</div>
                        </div>
                        <div class="excel-card">
                            <div class="card-label">Gesamtzeit</div>
                            <div class="card-value" id="total-time">0 Min</div>
                        </div>
                        <div class="excel-card">
                            <div class="card-label">Durchschnitt</div>
                            <div class="card-value" id="avg-time">-- Min</div>
                        </div>
                    </div>

                    <!-- Achievements -->
                    <div class="excel-card achievements-section">
                        <h3>Achievements</h3>
                        <div class="achievements-grid" id="achievements-grid">
                            <!-- Wird dynamisch gefüllt -->
                        </div>
                    </div>

                    <!-- Aufgaben-Tabelle -->
                    <div class="excel-card">
                        <h3>Deine Aufgaben</h3>
                        <div class="table-container">
                            <table class="excel-table" id="progress-table">
                                <thead>
                                    <tr>
                                        <th>Tag</th>
                                        <th>Aufgabe</th>
                                        <th>Status</th>
                                        <th>Zeit (Min)</th>
                                        <th>Stern</th>
                                        <th>Code</th>
                                        <th>Punkte</th>
                                    </tr>
                                </thead>
                                <tbody id="progress-table-body">
                                    <!-- Wird dynamisch gefüllt -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Eingabe-Formular -->
                    <div class="excel-card">
                        <h3>Lösung eintragen</h3>
                        <form id="solution-form" class="solution-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="task-select">Tag:</label>
                                    <select id="task-select" class="excel-input" required>
                                        <option value="">Tag auswählen...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="time-input">Zeit (Min):</label>
                                    <input type="number" id="time-input" class="excel-input" min="1" max="999" placeholder="z.B. 15">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Stern:</label>
                                    <div class="star-selector">
                                        <button type="button" class="star-btn" data-stars="3">Gold</button>
                                        <button type="button" class="star-btn" data-stars="2">Silber</button>
                                        <button type="button" class="star-btn" data-stars="1">Bronze</button>
                                    </div>
                                    <input type="hidden" id="stars-input" value="">
                                </div>
                                <div class="form-group">
                                    <label for="code-input">Lösungscode:</label>
                                    <input type="text" id="code-input" class="excel-input" placeholder="z.B. S" maxlength="10" required>
                                </div>
                            </div>
                            <button type="submit" class="excel-button excel-button-primary">Speichern</button>
                        </form>
                    </div>

                    <!-- Export/Import -->
                    <div class="excel-card">
                        <h3>Daten-Verwaltung</h3>
                        <div class="button-group">
                            <button id="export-btn" class="excel-button">Exportieren (JSON)</button>
                            <button id="import-btn" class="excel-button">Importieren</button>
                            <button id="reset-btn" class="excel-button excel-button-danger">Reset</button>
                        </div>
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                    </div>
                </div>
            </section>

            <!-- Tab 3: Alle Aufgaben -->
            <section id="tasks-tab" class="tab-content">
                <div class="tasks-container">
                    <h2>Alle Aufgaben</h2>

                    <div class="filter-bar">
                        <div class="filter-group">
                            <label>Filter:</label>
                            <button class="filter-btn active" data-filter="all">Alle</button>
                            <button class="filter-btn" data-filter="solved">Gelöst</button>
                            <button class="filter-btn" data-filter="open">Offen</button>
                        </div>
                    </div>

                    <div class="tasks-grid" id="tasks-grid">
                        <!-- Wird dynamisch gefüllt -->
                    </div>

                    <div class="download-all-section">
                        <button id="download-all-btn" class="excel-button excel-button-primary excel-button-large">
                            Alle Aufgaben als ZIP herunterladen
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tab 4: Info -->
            <section id="info-tab" class="tab-content">
                <div class="info-container">
                    <h2>Über den Adventskalender</h2>

                    <div class="excel-card">
                        <h3>Die Geschichte</h3>
                        <p>
                            Es ist der 1. Dezember und Panik bricht im Nordpol aus! Ein mysteriöser Computervirus
                            namens "GRINCH.exe" hat Santas gesamte digitale Werkstatt lahmgelegt. Alle Systeme sind
                            verschlüsselt, die Produktionsdatenbanken sind gesperrt, und die Geschenklisten sind nicht
                            mehr zugänglich.
                        </p>
                        <p>
                            Du bist Santas beste*r Datenanalyst*in und die einzige Hoffnung, Weihnachten zu retten.
                            Mit deinen fortgeschrittenen Excel-Kenntnissen musst du dich durch 24 verschlüsselte
                            Systeme arbeiten, um die Werkstatt rechtzeitig bis Heiligabend wieder funktionsfähig zu machen.
                        </p>
                    </div>

                    <div class="excel-card">
                        <h3>Wie funktioniert's?</h3>
                        <ol class="info-list">
                            <li>Klicke auf ein Geschenk im Kalender, um die Aufgabe herunterzuladen</li>
                            <li>Öffne die Excel-Datei und lies die Geschichte</li>
                            <li>Löse die Aufgabe mit Excel-Formeln und -Funktionen</li>
                            <li>Finde den Lösungscode (meist ein Buchstabe oder Zahl)</li>
                            <li>Trage Zeit, Stern und Code im Fortschritts-Tab ein</li>
                            <li>Sammle alle 24 Codes für das finale Master-Passwort!</li>
                        </ol>
                    </div>

                    <div class="excel-card">
                        <h3>Punktesystem</h3>
                        <table class="info-table">
                            <tr>
                                <td><strong>Gold</strong></td>
                                <td>Aufgabe in unter 10 Minuten gelöst</td>
                                <td class="points-cell">3 Punkte</td>
                            </tr>
                            <tr>
                                <td><strong>Silber</strong></td>
                                <td>Aufgabe in unter 15 Minuten gelöst</td>
                                <td class="points-cell">2 Punkte</td>
                            </tr>
                            <tr>
                                <td><strong>Bronze</strong></td>
                                <td>Aufgabe gelöst (egal wie lange)</td>
                                <td class="points-cell">1 Punkt</td>
                            </tr>
                        </table>
                        <p><strong>Maximum:</strong> 24 Aufgaben × 3 Punkte = 72 Punkte</p>
                    </div>

                    <div class="excel-card">
                        <h3>Technische Anforderungen</h3>
                        <ul class="info-list">
                            <li><strong>Excel-Version:</strong> Excel 2019 oder Microsoft 365 empfohlen</li>
                            <li><strong>Browser:</strong> Chrome, Firefox, Safari oder Edge (aktuellste Version)</li>
                            <li><strong>Excel-Kenntnisse:</strong> Fortgeschritten empfohlen</li>
                            <li><strong>Zeit pro Aufgabe:</strong> 15-30 Minuten einplanen</li>
                        </ul>
                    </div>

                    <div class="excel-card">
                        <h3>Tipps</h3>
                        <ul class="info-list">
                            <li>Jede Aufgabe hat 3 Hinweise im "Hinweise"-Tabellenblatt</li>
                            <li>Das "Validierung"-Blatt prüft deine Lösung automatisch</li>
                            <li>Bei deutschen Excel-Versionen: Semikolon (;) statt Komma in Formeln</li>
                            <li>Speichere deinen Fortschritt regelmäßig!</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Tab 5: FAQ -->
            <section id="faq-tab" class="tab-content">
                <div class="faq-container">
                    <h2>Häufig gestellte Fragen</h2>

                    <div class="faq-list">
                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Muss ich die Aufgaben in Reihenfolge lösen?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Nein, du kannst die Aufgaben in beliebiger Reihenfolge lösen. Es wird aber empfohlen,
                                    mit Tag 1 zu beginnen, da die Schwierigkeit progressiv steigt. Die ersten 6 Tage sind
                                    einfacher und dienen als Aufwärmung.
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Was wenn ich eine Aufgabe nicht lösen kann?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Jede Excel-Datei enthält ein "Hinweise"-Tabellenblatt mit 3 gestuften Hilfestellungen.
                                    Von klein (Richtungshinweis) bis groß (fast komplette Lösung). Keine Scheu - die Hinweise
                                    sind dafür da!
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Funktionieren die Dateien offline?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Ja! Sobald du eine Excel-Datei heruntergeladen hast, kannst du sie komplett offline nutzen.
                                    Du brauchst nur Excel installiert. Das Tracking auf dieser Website funktioniert auch offline,
                                    da es im Browser gespeichert wird (localStorage).
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Kann ich meinen Fortschritt sichern?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Ja! Im "Fortschritt"-Tab findest du unten die "Exportieren"-Funktion. Damit kannst
                                    du deinen Fortschritt als JSON-Datei herunterladen. Diese kannst du dann später wieder
                                    importieren oder auf einem anderen Gerät nutzen.
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Was ist das Master-Passwort?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Jede gelöste Aufgabe gibt dir einen Lösungscode (Buchstabe oder Zahl). Wenn du alle 23 Codes
                                    von Tag 1-23 gesammelt hast, ergibt deren Kombination das Master-Passwort für die finale
                                    Aufgabe am Tag 24. Dort musst du alle Codes eingeben, um Weihnachten endgültig zu retten!
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Meine Formeln funktionieren nicht - warum?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    <strong>Häufigste Ursache:</strong> Deutsche vs. Englische Excel-Version<br>
                                    - Deutsche Version: Semikolon (;) als Trennzeichen<br>
                                    - Englische Version: Komma (,) als Trennzeichen<br><br>
                                    Beispiel: =WENN(A1>10;"Ja";"Nein") vs. =IF(A1>10,"Yes","No")<br><br>
                                    Die Aufgaben verwenden deutsche Funktionsnamen. Bei englischer Excel-Version musst du
                                    die Funktionsnamen übersetzen (z.B. WENN → IF, SUMME → SUM).
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Brauche ich Excel 365 oder reicht Excel 2019?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Die meisten Aufgaben funktionieren mit Excel 2019. Einige fortgeschrittene Features
                                    (dynamische Arrays wie FILTER, SORTIEREN) benötigen Excel 365. Falls du Excel 2019 hast,
                                    kannst du diese Aufgaben mit alternativen Methoden (z.B. Pivot-Tabellen) lösen.
                                </p>
                            </div>
                        </div>

                        <div class="faq-item excel-card">
                            <button class="faq-question">
                                <span>Wie setze ich meinen Fortschritt zurück?</span>
                                <span class="faq-icon">▼</span>
                            </button>
                            <div class="faq-answer">
                                <p>
                                    Im "Fortschritt"-Tab findest du unten den Button "Reset". Dieser löscht alle
                                    gespeicherten Daten (Name, Lösungen, Punkte). <strong>Achtung:</strong> Diese Aktion
                                    kann nicht rückgängig gemacht werden! Exportiere vorher deinen Fortschritt, falls du
                                    ihn behalten möchtest.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Excel Adventskalender</p>
            <p class="footer-note">Alle Daten werden nur lokal in deinem Browser gespeichert (localStorage)</p>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Download Modal -->
    <div id="download-modal" class="modal">
        <div class="modal-content excel-card">
            <button class="modal-close">&times;</button>
            <h3 id="modal-title">Tag X heruntergeladen!</h3>
            <p id="modal-text">Viel Erfolg beim Lösen!</p>
            <p class="modal-hint">Vergiss nicht, deinen Fortschritt im "Fortschritt"-Tab einzutragen!</p>
            <button class="excel-button excel-button-primary" onclick="closeModal()">OK</button>
        </div>
    </div>

    <!-- Welcome Modal -->
    <div id="welcome-modal" class="modal">
        <div class="modal-content excel-card">
            <h2>Willkommen beim Excel Adventskalender!</h2>
            <p>Bereit, Weihnachten zu retten?</p>
            <div class="welcome-input">
                <label for="welcome-name">Wie heißt du?</label>
                <input type="text" id="welcome-name" class="excel-input" placeholder="Dein Name...">
            </div>
            <button class="excel-button excel-button-primary" id="welcome-start-btn">Los geht's!</button>
            <button class="excel-button" onclick="closeWelcomeModal(true)">Überspringen</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/tracker.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
